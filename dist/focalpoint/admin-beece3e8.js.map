{"version":3,"sources":["webpack:///./node_modules/@wpackio/entrypoint/lib/index.js","webpack:///./assets/styles/focal-point-admin.scss?108f","webpack:///./assets/scripts/modules/focal-picker.js","webpack:///./assets/scripts/focal-point-admin.js"],"names":["path","replace","window","FocalPicker","init","view","position","model","get","wrapper","$el","find","point","picker","image","setEventListeners","positionFocalPoint","jQuery","on","updateInterface","e","setFocalPoint","ui","draggable","cursor","start","startDrag","drag","dragging","stop","stopDrag","containment","css","width","set","left","x","top","y","pointYOffset","offsetY","height","pointXOffset","offsetX","Math","round","saveFocalPoint","attachment","_wp","_wp$ajax","_wp$ajax$settings","request","abort","ajax","url","wp","settings","method","data","action","attributes","beforeSend","updateSave","done","update","fail","jqXHR","textStatus","console","error","statusText","always","addClass","target","offsetLeft","offsetTop","removeClass","document","ready","_wp2","_wp2$media","_wp2$media$view","_wp3","_wp3$media","_wp3$media$view","_wp3$media$view$Attac","_wp4","_wp4$media","_wp4$media$view","_wp4$media$view$Attac","_wp4$media$view$Attac2","initAttachmentDetails","element","_wp$media","mediaView","media","template","mediaParent","mediaImage","length","prepend","mediaWrapper","prependTo","Attachment","AttachmentDetails","Details","TwoColumnView","TwoColumn","extend","initialize","this","change","render","prototype","apply","arguments","type","focalPoint","views","detach","fetch"],"mappings":"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","file":"focalpoint/admin-beece3e8.js","sourcesContent":["/* eslint-disable camelcase */ /* eslint-disable babel/camelcase */ /* eslint-disable no-underscore-dangle */ // eslint-disable-next-line no-unused-vars\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\n/* global __webpack_public_path__ */ // eslint-disable-next-line spaced-comment\n///<reference types=\"webpack-env\" />\n// We expect __webpack_public_path__ to be present, thanks to webpack\n// We are not using DOM in the typescript library, so let's just hack our way\n// through window\n// tslint:disable-next-line:no-any\n// We would override __webpack_public_path__ only if __WPACKIO__ webpack plugin is set\nif(__WPACKIO__){const path=(__WPACKIO__.appName+__WPACKIO__.outputPath).replace(/[^a-zA-Z0-9_-]/g,'');// eslint-disable-next-line no-global-assign\n__webpack_public_path__=window[`__wpackIo${path}`];}","// extracted by mini-css-extract-plugin\nexport {};","/**\n * Focal Point Picker module\n */\nconst FocalPicker = {\n\tinit: view => {\n\t\t// Set properties\n\t\tFocalPicker.view     = view;\n\t\tFocalPicker.position = view.model.get('focalPoint');\n\t\tFocalPicker.wrapper  = view.$el.find('.image-focal__wrapper');\n\t\tFocalPicker.point    = view.$el.find('.image-focal__point');\n\t\tFocalPicker.picker   = view.$el.find('.image-focal__clickarea');\n\t\tFocalPicker.image    = FocalPicker.wrapper.find('img');\n\t\t// Add event listners\n\t\tFocalPicker.setEventListeners();\n\t\tFocalPicker.positionFocalPoint(FocalPicker.position);\n\t},\n\tsetEventListeners: () => {\n\t\t// On layout change\n\t\tjQuery(window).on('resize', FocalPicker.updateInterface);\n\t\tFocalPicker.image.on('load', e => {\n\t\t\tFocalPicker.updateInterface();\n\t\t});\n\n\t\t// On click\n\t\tFocalPicker.picker.on('click', FocalPicker.setFocalPoint);\n\n\t\t// On drag\n\t\tif (typeof(jQuery.ui.draggable) === 'function') {\n\t\t\tFocalPicker.point.draggable({\n\t\t\t\tcursor: 'move',\n\t\t\t\tstart: FocalPicker.startDrag,\n\t\t\t\tdrag: FocalPicker.dragging,\n\t\t\t\tstop: FocalPicker.stopDrag,\n\t\t\t\tcontainment: FocalPicker.wrapper\n\t\t\t});\n\t\t}\n\t},\n\tupdateInterface: () => {\n\t\tFocalPicker.wrapper.css({\n\t\t\twidth: `${FocalPicker.image.width()}px`\n\t\t});\n\t},\n\tpositionFocalPoint: position => {\n\t\tFocalPicker.view.model.set('focalPoint', position);\n\t\tFocalPicker.point.css({\n\t\t\tleft: `${position?.x}%`,\n\t\t\ttop: `${position?.y}%`,\n\t\t\tposition: 'absolute'\n\t\t});\n\t},\n\tsetFocalPoint: e => {\n\t\tconst pointYOffset = e.offsetY - FocalPicker.point.height() / 2;\n\t\tconst pointXOffset = e.offsetX - FocalPicker.point.width() / 2;\n\n\t\t// Convert absolute coordinates to percentages\n\t\tFocalPicker.position.x = Math.round(pointXOffset / FocalPicker.picker.width() * 100);\n\t\tFocalPicker.position.y = Math.round(pointYOffset / FocalPicker.picker.height() * 100);\n\n\t\tFocalPicker.positionFocalPoint(FocalPicker.position);\n\t\tFocalPicker.saveFocalPoint(FocalPicker.view.model);\n\t},\n\tsaveFocalPoint: attachment => {\n\t\tlet request;\n\t\tif (request) {\n\t\t\trequest.abort();\n\t\t}\n\n\t\trequest = jQuery.ajax({\n\t\t\turl: wp?.ajax?.settings?.url,\n\t\t\tmethod: 'POST',\n\t\t\tdata: {\n\t\t\t\taction: 'save_focal_point',\n\t\t\t\tattachment: attachment?.attributes\n\t\t\t},\n\t\t\tbeforeSend: () => {\n\t\t\t\tFocalPicker.view.updateSave('waiting');\n\t\t\t}\n\t\t})\n\t\t.done(data => {\n\t\t\tFocalPicker.view.update();\n\t\t})\n\t\t.fail((jqXHR, textStatus) => {\n\t\t\tconsole.error('ResponsivePics error while saving focal point', jqXHR.statusText);\n\t\t})\n\t\t.always(() => {\n\t\t\tFocalPicker.view.updateSave('ready');\n\t\t\trequest = null;\n\t\t});\n\t},\n\tstartDrag: e => {\n\t\tjQuery('body').addClass('focal-point-dragging');\n\t},\n\tdragging: e => {\n\t\tFocalPicker.position.x = Math.round(e.target.offsetLeft / FocalPicker.picker.width() * 100);\n\t\tFocalPicker.position.y = Math.round(e.target.offsetTop / FocalPicker.picker.height() * 100);\n\t},\n\tstopDrag: e => {\n\t\tjQuery('body').removeClass('focal-point-dragging');\n\t\tFocalPicker.positionFocalPoint(FocalPicker.position);\n\t\tFocalPicker.saveFocalPoint(FocalPicker.view.model);\n\t}\n};\n\nexport default FocalPicker;","import FocalPicker from './modules/focal-picker';\n\n(function($) {\n\n\t$(document).ready(() => {\n\t\t/**\n\t\t * Attachment Details\n\t\t */\n\t\tconst initAttachmentDetails = element => {\n\t\t\t// Append focal point selector\n\t\t\tconst mediaView   = wp?.media?.template('attachment-details-focal-point');\n\t\t\tconst mediaParent = element.find('.thumbnail');\n\t\t\tconst mediaImage  = mediaParent.find('img');\n\n\t\t\t// Set image focal elements\n\t\t\tif (mediaView && mediaParent.length && mediaImage.length) {\n\t\t\t\tmediaParent.prepend(mediaView);\n\t\t\t\tconst mediaWrapper = mediaParent.find('.image-focal__wrapper');\n\t\t\t\tmediaImage.prependTo(mediaWrapper);\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Extend WP Media views\n\t\t */\n\t\tconst Attachment = wp?.media?.view?.Attachment;\n\t\tconst AttachmentDetails = wp?.media?.view?.Attachment?.Details;\n\t\tconst TwoColumnView = wp?.media?.view?.Attachment?.Details?.TwoColumn;\n\n\t\t/**\n\t\t * Extend Attachment Details TwoColumn view (Media Library Modal)\n\t\t */\n\t\tif (TwoColumnView) {\n\t\t\twp.media.view.Attachment.Details.TwoColumn = TwoColumnView.extend({\n\t\t\t\t// Add focalPoint change listener\n\t\t\t\tinitialize: function() {\n\t\t\t\t\tthis.model.on('change:focalPoint', this.change, this);\n\t\t\t\t},\n\t\t\t\t// Init extended template\n\t\t\t\trender: function() {\n\t\t\t\t\tAttachment.prototype.render.apply(this, arguments);\n\t\t\t\t\tconst type = this.model.get('type');\n\n\t\t\t\t\tif (type === 'image') {\n\t\t\t\t\t\tinitAttachmentDetails(this.$el);\n\t\t\t\t\t\tFocalPicker.init(this);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Re-init focal point on input change\n\t\t\t\tchange: function() {\n\t\t\t\t\tconst type = this.model.get('type');\n\t\t\t\t\tconst focalPoint = this.model.get('focalPoint');\n\n\t\t\t\t\tif (type === 'image') {\n\t\t\t\t\t\tFocalPicker.positionFocalPoint(focalPoint);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Update view on focal point js change\n\t\t\t\tupdate: function() {\n\t\t\t\t\tthis.views.detach();\n\t\t\t\t\tthis.model.fetch();\n\t\t\t\t\tthis.views.render();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * Extend Attachment Details view (Post Edit Modal)\n\t\t */\n\t\tif (AttachmentDetails) {\n\t\t\twp.media.view.Attachment.Details = AttachmentDetails.extend({\n\t\t\t\t// Add focalPoint change listener\n\t\t\t\tinitialize: function() {\n\t\t\t\t\tAttachment.prototype.initialize.apply(this, arguments);\n\t\t\t\t\tthis.model.on('change:focalPoint', this.change, this);\n\t\t\t\t},\n\t\t\t\t// Init extended template\n\t\t\t\trender: function() {\n\t\t\t\t\tAttachment.prototype.render.apply(this, arguments);\n\t\t\t\t\tconst id   = this.model.get('id');\n\t\t\t\t\tconst type = this.model.get('type');\n\n\t\t\t\t\tif (type === 'image') {\n\t\t\t\t\t\tinitAttachmentDetails(this.$el);\n\t\t\t\t\t\tFocalPicker.init(this);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Re-init focal point on input change\n\t\t\t\tchange: function() {\n\t\t\t\t\tconst type = this.model.get('type');\n\t\t\t\t\tconst focalPoint = this.model.get('focalPoint');\n\n\t\t\t\t\tif (type === 'image') {\n\t\t\t\t\t\tFocalPicker.positionFocalPoint(focalPoint);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// Update view on focal point js change\n\t\t\t\tupdate: function() {\n\t\t\t\t\tthis.views.detach();\n\t\t\t\t\tthis.model.fetch();\n\t\t\t\t\tthis.views.render();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n})(jQuery);\n"],"sourceRoot":""}